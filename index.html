<html lang="en">
 <head>
  <meta charset="utf-8"/>
  <meta content="width=device-width, initial-scale=1" name="viewport"/>
  <title>
   Panwar&amp;Son's - Fashion &amp; Lifestyle E-Commerce
  </title>
  <link href="https://placehold.co/32x32/png?text=P" rel="icon" type="image/png"/>
  <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;600&amp;display=swap" rel="stylesheet"/>
  <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/all.min.css" rel="stylesheet"/>
  <script src="https://cdn.tailwindcss.com">
  </script>
  <style>
   /* Custom scrollbar for product gallery */
    .scrollbar-hide::-webkit-scrollbar {
      display: none;
    }
    .scrollbar-hide {
      -ms-overflow-style: none;
      scrollbar-width: none;
    }
  </style>
 </head>
 <body class="font-poppins bg-white text-gray-900">
  <header class="sticky top-0 z-50 bg-white shadow-md">
   <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
    <div class="flex justify-between items-center h-16">
     <a class="flex items-center space-x-2" href="#" id="nav-home">
      <img alt="Panwar &amp; Son's logo, stylized P letter in orange and pink gradient" class="h-12 w-12 object-contain" height="48" src="https://storage.googleapis.com/a1aa/image/3c4ae61f-5e2c-488a-0ae7-4c01a72e6be3.jpg" width="48"/>
      <span class="text-2xl font-bold text-pink-600 select-none">
       Panwar&amp;Son's
      </span>
     </a>
     <nav class="hidden md:flex space-x-8 font-semibold text-gray-700 items-center" id="desktop-nav-menu">
      <a class="hover:text-pink-600 transition cursor-pointer" id="nav-home-desktop">
       Home
      </a>
      <a class="hover:text-pink-600 transition cursor-pointer" id="nav-shop-desktop">
       Shop
      </a>
      <a class="hover:text-pink-600 transition cursor-pointer" id="nav-about-desktop">
       About
      </a>
      <a class="hover:text-pink-600 transition cursor-pointer" id="nav-contact-desktop">
       Contact
      </a>
     </nav>
     <div class="hidden md:flex items-center border border-gray-300 rounded-md overflow-hidden focus-within:ring-2 focus-within:ring-pink-500 focus-within:border-pink-500 mx-4 flex-grow max-w-md">
      <input aria-label="Search" class="px-3 py-2 w-full focus:outline-none" id="search-input" placeholder="Search for products, brands and more" type="text"/>
      <button aria-label="Search" class="px-3 text-pink-600 hover:text-pink-800" id="search-button">
       <i class="fas fa-search">
       </i>
      </button>
     </div>
     <div class="flex items-center space-x-4" id="user-actions">
      <button aria-label="User login or register" class="hidden md:flex items-center space-x-1 text-gray-700 hover:text-pink-600 transition cursor-pointer" id="nav-login-desktop">
       <i class="fas fa-user">
       </i>
       <span class="font-semibold">
        Login / Signup
       </span>
      </button>
      <button aria-label="Shopping cart" class="relative text-gray-700 hover:text-pink-600 transition cursor-pointer" id="nav-cart-desktop">
       <i class="fas fa-shopping-cart fa-lg">
       </i>
       <span class="absolute -top-2 -right-2 bg-pink-600 text-white rounded-full text-xs w-5 h-5 flex items-center justify-center font-semibold" id="cart-count">
        0
       </span>
      </button>
     </div>
     <div class="hidden md:flex items-center space-x-2 cursor-pointer" id="user-avatar-container">
      <img alt="User profile photo" class="h-10 w-10 rounded-full object-cover" id="user-avatar" src="" width="40" height="40"/>
      <span class="font-semibold text-gray-700" id="user-email-display"></span>
      <button aria-label="Logout" class="text-pink-600 hover:text-pink-800 transition" id="logout-btn" title="Logout">
       <i class="fas fa-sign-out-alt"></i>
      </button>
     </div>
     <button aria-label="Open menu" class="md:hidden text-gray-700 hover:text-pink-600 transition focus:outline-none focus:ring-2 focus:ring-pink-500 rounded" id="mobile-menu-button">
      <i class="fas fa-bars fa-lg">
      </i>
     </button>
    </div>
   </div>
   <nav class="hidden md:hidden bg-white border-t border-gray-200" id="mobile-menu">
    <div class="px-4 pt-4 pb-2 space-y-1 font-semibold text-gray-700">
     <a class="block py-2 hover:bg-pink-50 hover:text-pink-600 rounded cursor-pointer" id="nav-home-mobile">
      Home
     </a>
     <a class="block py-2 hover:bg-pink-50 hover:text-pink-600 rounded cursor-pointer" id="nav-shop-mobile">
      Shop
     </a>
     <a class="block py-2 hover:bg-pink-50 hover:text-pink-600 rounded cursor-pointer" id="nav-about-mobile">
      About
     </a>
     <a class="block py-2 hover:bg-pink-50 hover:text-pink-600 rounded cursor-pointer" id="nav-contact-mobile">
      Contact
     </a>
     <a class="block py-2 hover:bg-pink-50 hover:text-pink-600 rounded flex items-center space-x-2 cursor-pointer" id="nav-login-mobile">
      <i class="fas fa-user">
      </i>
      <span>
       Login / Signup
      </span>
     </a>
    </div>
    <div class="px-4 pb-4">
     <form class="flex items-center border border-gray-300 rounded-md overflow-hidden focus-within:ring-2 focus-within:ring-pink-500 focus-within:border-pink-500" id="mobile-search-form">
      <input aria-label="Search" class="px-3 py-2 w-full focus:outline-none" id="mobile-search-input" placeholder="Search for products, brands and more" type="text"/>
      <button aria-label="Search" class="px-3 text-pink-600 hover:text-pink-800" id="mobile-search-button" type="submit">
       <i class="fas fa-search">
       </i>
      </button>
     </form>
    </div>
   </nav>
  </header>
  <main class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 mt-6 mb-16 min-h-[80vh]" id="main-content">
   </main>
  <footer class="bg-gray-900 text-gray-300">
   <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-12 grid grid-cols-1 md:grid-cols-4 gap-8">
    <div>
     <a class="flex items-center space-x-2 mb-4 cursor-pointer select-none" id="footer-logo">
      <img alt="Panwar &amp; Son's logo, stylized P letter in orange and pink gradient" class="h-10 w-10 object-contain" height="40" src="https://storage.googleapis.com/a1aa/image/3c4ae61f-5e2c-488a-0ae7-4c01a72e6be3.jpg" width="40"/>
      <span class="text-white text-xl font-bold">
       Panwar&amp;Son's
      </span>
     </a>
     <p class="text-gray-400 max-w-xs">
      Your one-stop destination for the latest fashion and lifestyle products. Shop with confidence and style.
     </p>
    </div>
    <div>
     <h3 class="text-white font-semibold mb-4">
      About
     </h3>
     <ul class="space-y-2 text-gray-400">
      <li>
       <a class="hover:text-pink-500 transition cursor-pointer" id="footer-our-story">
        Our Story
       </a>
      </li>
      <li>
       <a class="hover:text-pink-500 transition cursor-pointer" id="footer-careers">
        Careers
       </a>
      </li>
      <li>
       <a class="hover:text-pink-500 transition cursor-pointer" id="footer-press">
        Press
       </a>
      </li>
      <li>
       <a class="hover:text-pink-500 transition cursor-pointer" id="footer-blog">
        Blog
       </a>
      </li>
     </ul>
    </div>
    <div>
     <h3 class="text-white font-semibold mb-4">
      Help
     </h3>
     <ul class="space-y-2 text-gray-400">
      <li>
       <a class="hover:text-pink-500 transition cursor-pointer" id="footer-customer-service">
        Customer Service
       </a>
      </li>
      <li>
       <a class="hover:text-pink-500 transition cursor-pointer" id="footer-returns">
        Returns &amp; Refunds
       </a>
      </li>
      <li>
       <a class="hover:text-pink-500 transition cursor-pointer" id="footer-shipping-info">
        Shipping Info
       </a>
      </li>
      <li>
       <a class="hover:text-pink-500 transition cursor-pointer" id="footer-faqs">
        FAQs
       </a>
      </li>
     </ul>
    </div>
    <div>
     <h3 class="text-white font-semibold mb-4">
      Follow Us
     </h3>
     <div class="flex space-x-6 text-gray-400">
      <a aria-label="Facebook" class="hover:text-pink-500 transition" href="#">
       <i class="fab fa-facebook fa-lg">
       </i>
      </a>
      <a aria-label="Twitter" class="hover:text-pink-500 transition" href="#">
       <i class="fab fa-twitter fa-lg">
       </i>
      </a>
      <a aria-label="Instagram" class="hover:text-pink-500 transition" href="#">
       <i class="fab fa-instagram fa-lg">
       </i>
      </a>
      <a aria-label="YouTube" class="hover:text-pink-500 transition" href="#">
       <i class="fab fa-youtube fa-lg">
       </i>
      </a>
     </div>
     <h3 class="text-white font-semibold mt-8 mb-4">
      Download App
     </h3>
     <div class="flex space-x-4">
      <a aria-label="Download on the App Store" class="block" href="#">
       <img alt="App Store download badge with white text on black background" class="h-10 object-contain" height="40" src="https://storage.googleapis.com/a1aa/image/2c9e3cea-982a-4d80-077d-15aae4660c38.jpg" width="120"/>
      </a>
      <a aria-label="Get it on Google Play" class="block" href="#">
       <img alt="Google Play download badge with white text on black background" class="h-10 object-contain" height="40" src="https://storage.googleapis.com/a1aa/image/6c3e6e1f-42a2-4e52-6cae-cede0c1dc645.jpg" width="120"/>
      </a>
     </div>
    </div>
   </div>
   <div class="border-t border-gray-800 text-center py-4 text-gray-500 text-sm select-none">
    Â© 2024 Panwar&amp;Son's. All rights reserved.
   </div>
  </footer>
  <script>
   // Data for products by category
    const productsData = {
      Men: [
        {
          id: 'men1',
          name: "Panwar's coolection",
          price: 799,
          rating: 3.5,
          reviews: 120,
          image: "crop.png",
          alt: "Men's casual shirt in blue color displayed on a mannequin",
          sizes: ['S', 'M', 'L', 'XL'],
          colors: ['Blue', 'White', 'Black'],
          description: "Comfortable and stylish casual shirt perfect for everyday wear."
        },
        {
          id: 'men2',
          name: "Men's Formal Trousers",
          price: 1299,
          rating: 4,
          reviews: 85,
          image: "https://placehold.co/300x400/png?text=Men's+Formal+Trousers",
          alt: "Men's formal trousers in black color displayed on a mannequin",
          sizes: ['30', '32', '34', '36'],
          colors: ['Black', 'Gray'],
          description: "Elegant formal trousers suitable for office and formal occasions."
        },
        {
          id: 'men3',
          name: "Men's Sneakers",
          price: 2499,
          rating: 4.5,
          reviews: 150,
          image: "https://storage.googleapis.com/a1aa/image/1f607f58-f14c-4e96-fdc2-9e34d55dda25.jpg",
          alt: "Pair of red and white running shoes with breathable mesh design",
          sizes: ['7', '8', '9', '10', '11'],
          colors: ['Red/White', 'Black/White'],
          description: "Lightweight and comfortable sneakers for running and casual wear."
        }
      ],
      Women: [
        {
          id: 'women1',
          name: "Women's Floral Dress",
          price: 1299,
          rating: 4,
          reviews: 89,
          image: "https://storage.googleapis.com/a1aa/image/1ea48080-a232-431b-40ce-13b5799d2d4e.jpg",
          alt: "Women's floral summer dress in bright colors displayed on a mannequin",
          sizes: ['S', 'M', 'L', 'XL'],
          colors: ['Floral', 'Red', 'Blue'],
          description: "Bright and breezy floral dress perfect for summer outings."
        },
        {
          id: 'women2',
          name: "Women's Handbag",
          price: 4499,
          rating: 3.5,
          reviews: 67,
          image: "https://storage.googleapis.com/a1aa/image/8a45d413-1c85-4cc4-3982-16d971e35df0.jpg",
          alt: "Elegant brown leather handbag with gold accents on a white background",
          sizes: [],
          colors: ['Brown', 'Black'],
          description: "Elegant leather handbag with spacious compartments."
        },
        {
          id: 'women3',
          name: "Women's Sandals",
          price: 1599,
          rating: 4.2,
          reviews: 110,
          image: "https://placehold.co/300x400/png?text=Women's+Sandals",
          alt: "Pair of women's sandals in beige color with straps",
          sizes: ['5', '6', '7', '8'],
          colors: ['Beige', 'Black'],
          description: "Comfortable and stylish sandals for everyday wear."
        }
      ],
      Electronics: [
        {
          id: 'elec1',
          name: "Wireless Headphones",
          price: 2499,
          rating: 3.5,
          reviews: 45,
          image: "https://storage.googleapis.com/a1aa/image/fee56216-76d0-491e-be0c-f09bdf762418.jpg",
          alt: "Wireless over-ear headphones in black color with modern design",
          sizes: [],
          colors: ['Black', 'White'],
          description: "High-quality wireless headphones with noise cancellation."
        },
        {
          id: 'elec2',
          name: "Smartwatch",
          price: 4999,
          rating: 4.5,
          reviews: 78,
          image: "https://placehold.co/300x400/png?text=Smartwatch",
          alt: "Smartwatch with black strap and digital display",
          sizes: [],
          colors: ['Black', 'Silver'],
          description: "Feature-rich smartwatch with fitness tracking and notifications."
        },
        {
          id: 'elec3',
          name: "Bluetooth Speaker",
          price: 1999,
          rating: 4,
          reviews: 60,
          image: "https://placehold.co/300x400/png?text=Bluetooth+Speaker",
          alt: "Portable Bluetooth speaker in blue color",
          sizes: [],
          colors: ['Blue', 'Black'],
          description: "Portable Bluetooth speaker with excellent sound quality."
        }
      ],
      Footwear: [
        {
          id: 'foot1',
          name: "Running Shoes",
          price: 3199,
          rating: 5,
          reviews: 210,
          image: "https://storage.googleapis.com/a1aa/image/1f607f58-f14c-4e96-fdc2-9e34d55dda25.jpg",
          alt: "Pair of red and white running shoes with breathable mesh design",
          sizes: ['7', '8', '9', '10', '11'],
          colors: ['Red/White', 'Black/White'],
          description: "Lightweight and comfortable running shoes."
        },
        {
          id: 'foot2',
          name: "Casual Sneakers",
          price: 2799,
          rating: 4.3,
          reviews: 95,
          image: "https://placehold.co/300x400/png?text=Casual+Sneakers",
          alt: "Pair of casual sneakers in white color",
          sizes: ['6', '7', '8', '9', '10'],
          colors: ['White', 'Gray'],
          description: "Trendy casual sneakers for everyday use."
        }
      ],
      Accessories: [
        {
          id: 'acc1',
          name: "Leather Wallet",
          price: 999,
          rating: 4.1,
          reviews: 50,
          image: "https://placehold.co/300x400/png?text=Leather+Wallet",
          alt: "Brown leather wallet with multiple compartments",
          sizes: [],
          colors: ['Brown', 'Black'],
          description: "Durable leather wallet with multiple card slots."
        },
        {
          id: 'acc2',
          name: "Sunglasses",
          price: 1499,
          rating: 4.6,
          reviews: 80,
          image: "https://placehold.co/300x400/png?text=Sunglasses",
          alt: "Stylish black sunglasses with UV protection",
          sizes: [],
          colors: ['Black', 'Brown'],
          description: "UV protected sunglasses with stylish frame."
        }
      ],
      Kids: [
        {
          id: 'kids1',
          name: "Kids T-Shirt",
          price: 499,
          rating: 4.2,
          reviews: 40,
          image: "https://placehold.co/300x400/png?text=Kids+T-Shirt",
          alt: "Colorful kids t-shirt with cartoon print",
          sizes: ['XS', 'S', 'M'],
          colors: ['Red', 'Blue', 'Green'],
          description: "Comfortable cotton t-shirt for kids."
        },
        {
          id: 'kids2',
          name: "Kids Toy Set",
          price: 799,
          rating: 4.8,
          reviews: 30,
          image: "https://placehold.co/300x400/png?text=Kids+Toy+Set",
          alt: "Colorful kids toy set with blocks and cars",
          sizes: [],
          colors: [],
          description: "Fun and educational toy set for kids."
        }
      ]
    };

    // Cart data
    let cart = [];

    // User data
    let user = null; // {email, photoURL}

    // Current page state
    let currentPage = 'home'; // home, shop, product, cart, checkout, about, contact, login, thankyou, 404
    let currentCategory = null;
    let currentProduct = null;

    // Utility: format price
    function formatPrice(price) {
      return `â¹${price.toLocaleString('en-IN')}`;
    }

    // Utility: create star rating HTML
    function createStarRating(rating, reviews) {
      let fullStars = Math.floor(rating);
      let halfStar = rating - fullStars >= 0.5;
      let emptyStars = 5 - fullStars - (halfStar ? 1 : 0);
      let starsHtml = '';
      for(let i=0; i<fullStars; i++) {
        starsHtml += '<i class="fas fa-star"></i>';
      }
      if(halfStar) {
        starsHtml += '<i class="fas fa-star-half-alt"></i>';
      }
      for(let i=0; i<emptyStars; i++) {
        starsHtml += '<i class="far fa-star"></i>';
      }
      starsHtml += `<span class="text-gray-500 text-sm ml-2">(${reviews})</span>`;
      return starsHtml;
    }

    // Update header user display
    function updateUserDisplay() {
      const userActions = document.getElementById('user-actions');
      const avatarContainer = document.getElementById('user-avatar-container');
      if (user) {
        // Show avatar and email, hide login button
        userActions.style.display = 'none';
        avatarContainer.style.display = 'flex';
        document.getElementById('user-avatar').src = user.photoURL || 'https://placehold.co/40x40/png?text=User';
        document.getElementById('user-email-display').textContent = user.email;
      } else {
        // Show login button, hide avatar
        userActions.style.display = 'flex';
        avatarContainer.style.display = 'none';
      }
    }

    // Render Home Page
    function renderHome() {
      currentPage = 'home';
      currentCategory = null;
      currentProduct = null;
      const main = document.getElementById('main-content');
      main.innerHTML = `
      <section class="relative rounded-lg overflow-hidden shadow-lg">
        <img alt="Hero banner showing models wearing trendy clothes with text overlay about offers and featured products" class="w-full h-auto object-cover" height="480" src="https://storage.googleapis.com/a1aa/image/ab8cbd20-5c01-4801-734a-6a7bcbf1294e.jpg" width="1440"/>
        <div class="absolute inset-0 bg-gradient-to-r from-pink-600/70 to-pink-400/50 flex flex-col justify-center px-6 md:px-20">
          <h1 class="text-white text-4xl md:text-6xl font-extrabold max-w-xl leading-tight drop-shadow-lg">
            Discover Your Style with Panwar&amp;Son's
          </h1>
          <p class="mt-4 text-pink-100 text-lg md:text-xl max-w-md drop-shadow-md">
            Up to 50% off on top brands. Shop the latest fashion trends now!
          </p>
          <button id="hero-shop-now" class="mt-6 inline-block bg-white text-pink-600 font-semibold px-6 py-3 rounded-md shadow-md hover:bg-pink-50 transition w-max cursor-pointer">
            Shop Now
          </button>
        </div>
      </section>
      <section class="mt-12">
        <h2 class="text-2xl font-semibold text-gray-800 mb-6">
          Shop by Category
        </h2>
        <div class="grid grid-cols-2 sm:grid-cols-4 md:grid-cols-6 gap-6">
          <div class="group flex flex-col items-center space-y-2 hover:text-pink-600 transition cursor-pointer category-item" data-category="Men">
            <img alt="Category image showing men's clothing with casual and formal wear" class="rounded-lg object-cover w-28 h-28" height="120" src="https://storage.googleapis.com/a1aa/image/f50ac7c2-9860-4b64-b9d8-4e046377db70.jpg" width="120"/>
            <span class="font-medium text-center">
              Men
            </span>
          </div>
          <div class="group flex flex-col items-center space-y-2 hover:text-pink-600 transition cursor-pointer category-item" data-category="Women">
            <img alt="Category image showing women's clothing with dresses and tops" class="rounded-lg object-cover w-28 h-28" height="120" src="https://storage.googleapis.com/a1aa/image/ca7a2178-494a-42db-cfd6-55754bbc6151.jpg" width="120"/>
            <span class="font-medium text-center">
              Women
            </span>
          </div>
          <div class="group flex flex-col items-center space-y-2 hover:text-pink-600 transition cursor-pointer category-item" data-category="Electronics">
            <img alt="Category image showing electronic gadgets like headphones and smartwatches" class="rounded-lg object-cover w-28 h-28" height="120" src="https://storage.googleapis.com/a1aa/image/f342bc1f-abff-43e0-3108-f00da8404186.jpg" width="120"/>
            <span class="font-medium text-center">
              Electronics
            </span>
          </div>
          <div class="group flex flex-col items-center space-y-2 hover:text-pink-600 transition cursor-pointer category-item" data-category="Footwear">
            <img alt="Category image showing various footwear including sneakers and sandals" class="rounded-lg object-cover w-28 h-28" height="120" src="https://storage.googleapis.com/a1aa/image/56ba289b-9e94-41ab-e63d-813bdf58f364.jpg" width="120"/>
            <span class="font-medium text-center">
              Footwear
            </span>
          </div>
          <div class="group flex flex-col items-center space-y-2 hover:text-pink-600 transition cursor-pointer category-item" data-category="Accessories">
            <img alt="Category image showing fashion accessories like bags, watches, and sunglasses" class="rounded-lg object-cover w-28 h-28" height="120" src="https://storage.googleapis.com/a1aa/image/b4d08e2c-3d3f-47ca-50ac-cb1ddcc8c9a0.jpg" width="120"/>
            <span class="font-medium text-center">
              Accessories
            </span>
          </div>
          <div class="group flex flex-col items-center space-y-2 hover:text-pink-600 transition cursor-pointer category-item" data-category="Kids">
            <img alt="Category image showing kids clothing and toys" class="rounded-lg object-cover w-28 h-28" height="120" src="https://storage.googleapis.com/a1aa/image/e0f00960-58d0-44d6-5280-938ae48a3efd.jpg" width="120"/>
            <span class="font-medium text-center">
              Kids
            </span>
          </div>
        </div>
      </section>
      <section class="mt-16">
        <h2 class="text-2xl font-semibold text-gray-800 mb-6">
          Featured Products
        </h2>
        <div class="grid grid-cols-2 sm:grid-cols-3 md:grid-cols-4 lg:grid-cols-5 gap-6" id="featured-products">
        </div>
      </section>
      <section class="mt-20 bg-pink-50 rounded-lg p-8 shadow-md">
        <h2 class="text-2xl font-semibold text-gray-800 mb-8 text-center">
          What Our Customers Say
        </h2>
        <div class="grid grid-cols-1 md:grid-cols-3 gap-8">
          <blockquote class="bg-white p-6 rounded-lg shadow-sm">
            <p class="text-gray-700 italic">
              "Panwar &amp; Son's has the best collection of trendy clothes. The delivery was fast and the quality is amazing. Highly recommend!"
            </p>
            <footer class="mt-4 text-right font-semibold text-pink-600">
              - Anjali S.
            </footer>
          </blockquote>
          <blockquote class="bg-white p-6 rounded-lg shadow-sm">
            <p class="text-gray-700 italic">
              "I love shopping on Panwar &amp; Son's. The app is easy to use and the customer service is excellent."
            </p>
            <footer class="mt-4 text-right font-semibold text-pink-600">
              - Rohit K.
            </footer>
          </blockquote>
          <blockquote class="bg-white p-6 rounded-lg shadow-sm">
            <p class="text-gray-700 italic">
              "Great variety of products and amazing discounts. The size guide helped me pick the perfect fit."
            </p>
            <footer class="mt-4 text-right font-semibold text-pink-600">
              - Priya M.
            </footer>
          </blockquote>
        </div>
      </section>
      <section class="mt-20 bg-pink-600 rounded-lg p-8 text-white text-center shadow-lg">
        <h2 class="text-3xl font-bold mb-4">
          Subscribe to Our Newsletter
        </h2>
        <p class="mb-6 max-w-xl mx-auto">
          Get the latest updates on new arrivals, exclusive offers, and fashion tips delivered straight to your inbox.
        </p>
        <form class="max-w-md mx-auto flex flex-col sm:flex-row gap-4" id="newsletter-form" novalidate>
          <input aria-label="Email address" class="flex-grow px-4 py-3 rounded-md text-gray-900 focus:outline-none focus:ring-2 focus:ring-pink-300" id="newsletter-email" placeholder="Enter your email address" required type="email"/>
          <button class="bg-white text-pink-600 font-semibold rounded-md px-6 py-3 hover:bg-pink-50 transition" type="submit">
            Subscribe
          </button>
        </form>
      </section>
      `;
      // Render featured products (top 5 from all categories)
      const featuredContainer = document.getElementById('featured-products');
      let featuredProducts = [];
      for (const cat in productsData) {
        featuredProducts = featuredProducts.concat(productsData[cat]);
      }
      featuredProducts = featuredProducts.slice(0, 5);
      featuredContainer.innerHTML = featuredProducts.map(p => `
        <article class="border border-gray-200 rounded-lg overflow-hidden shadow-sm hover:shadow-lg transition relative group cursor-pointer product-card" data-id="${p.id}">
          <img alt="${p.alt}" class="w-full h-64 object-cover" height="400" src="${p.image}" width="300"/>
          <div class="p-4">
            <h3 class="text-gray-900 font-semibold text-lg truncate">${p.name}</h3>
            <p class="text-pink-600 font-bold mt-1">${formatPrice(p.price)}</p>
            <div class="flex items-center mt-2 space-x-1 text-yellow-400">${createStarRating(p.rating, p.reviews)}</div>
            <button aria-label="Add ${p.name} to cart" class="mt-4 w-full bg-pink-600 text-white py-2 rounded-md font-semibold hover:bg-pink-700 transition flex justify-center items-center space-x-2 add-to-cart-btn" data-id="${p.id}">
              <i class="fas fa-cart-plus"></i>
              <span>Add to Cart</span>
            </button>
          </div>
        </article>
      `).join('');
      attachHomeListeners();
    }

    // Render Shop Page (Category listing)
    function renderShop(category = null) {
      currentPage = 'shop';
      currentCategory = category;
      currentProduct = null;
      const main = document.getElementById('main-content');
      if (!category || !productsData[category]) {
        // Show categories list if no category selected
        main.innerHTML = `
          <h2 class="text-3xl font-semibold mb-6">Shop by Category</h2>
          <div class="grid grid-cols-2 sm:grid-cols-4 md:grid-cols-6 gap-6">
            ${Object.keys(productsData).map(cat => `
              <div class="group flex flex-col items-center space-y-2 hover:text-pink-600 transition cursor-pointer category-item" data-category="${cat}">
                <img alt="Category image for ${cat}" class="rounded-lg object-cover w-28 h-28" height="120" src="${getCategoryImage(cat)}" width="120"/>
                <span class="font-medium text-center">${cat}</span>
              </div>
            `).join('')}
          </div>
        `;
        attachCategoryListeners();
        return;
      }
      // Show products grid for category
      const products = productsData[category];
      main.innerHTML = `
        <div class="flex justify-between items-center mb-6">
          <h2 class="text-3xl font-semibold">${category}</h2>
          <button id="back-to-shop" class="text-pink-600 hover:underline cursor-pointer">Back to Categories</button>
        </div>
        <div class="grid grid-cols-2 sm:grid-cols-3 md:grid-cols-4 lg:grid-cols-5 gap-6" id="category-products">
          ${products.map(p => `
            <article class="border border-gray-200 rounded-lg overflow-hidden shadow-sm hover:shadow-lg transition relative group cursor-pointer product-card" data-id="${p.id}">
              <img alt="${p.alt}" class="w-full h-64 object-cover" height="400" src="${p.image}" width="300"/>
              <div class="p-4">
                <h3 class="text-gray-900 font-semibold text-lg truncate">${p.name}</h3>
                <p class="text-pink-600 font-bold mt-1">${formatPrice(p.price)}</p>
                <div class="flex items-center mt-2 space-x-1 text-yellow-400">${createStarRating(p.rating, p.reviews)}</div>
                <button aria-label="Add ${p.name} to cart" class="mt-4 w-full bg-pink-600 text-white py-2 rounded-md font-semibold hover:bg-pink-700 transition flex justify-center items-center space-x-2 add-to-cart-btn" data-id="${p.id}">
                  <i class="fas fa-cart-plus"></i>
                  <span>Add to Cart</span>
                </button>
              </div>
            </article>
          `).join('')}
        </div>
      `;
      document.getElementById('back-to-shop').addEventListener('click', () => {
        renderShop(null);
      });
      attachProductCardListeners();
      attachAddToCartListeners();
    }

    // Render Product Detail Page
    function renderProduct(productId) {
      currentPage = 'product';
      currentProduct = productId;
      currentCategory = null;
      const main = document.getElementById('main-content');
      let product = null;
      for (const cat in productsData) {
        product = productsData[cat].find(p => p.id === productId);
        if (product) break;
      }
      if (!product) {
        render404();
        return;
      }
      // Build size options
      const sizeOptions = product.sizes.length > 0 ? product.sizes.map(s => `<option value="${s}">${s}</option>`).join('') : '<option value="">N/A</option>';
      // Build color options
      const colorOptions = product.colors.length > 0 ? product.colors.map(c => `<option value="${c}">${c}</option>`).join('') : '<option value="">N/A</option>';
      main.innerHTML = `
        <div class="flex flex-col md:flex-row gap-8">
          <div class="md:w-1/2">
            <img alt="${product.alt}" class="w-full rounded-lg object-cover" height="500" src="${product.image}" width="400"/>
          </div>
          <div class="md:w-1/2 flex flex-col">
            <h1 class="text-3xl font-bold mb-2">${product.name}</h1>
            <div class="flex items-center space-x-3 mb-4">
              <div class="flex items-center space-x-1 text-yellow-400 text-lg">${createStarRating(product.rating, product.reviews)}</div>
              <span class="text-gray-500 text-sm">(${product.reviews} reviews)</span>
            </div>
            <p class="text-pink-600 text-2xl font-bold mb-4">${formatPrice(product.price)}</p>
            <p class="mb-6 text-gray-700">${product.description}</p>
            <form id="product-detail-form" class="space-y-4">
              <div>
                <label for="size-select" class="block font-semibold mb-1">Size</label>
                <select id="size-select" name="size" class="w-full border border-gray-300 rounded-md px-3 py-2" required>
                  ${sizeOptions}
                </select>
              </div>
              <div>
                <label for="color-select" class="block font-semibold mb-1">Color</label>
                <select id="color-select" name="color" class="w-full border border-gray-300 rounded-md px-3 py-2" required>
                  ${colorOptions}
                </select>
              </div>
              <div>
                <label for="quantity-input" class="block font-semibold mb-1">Quantity</label>
                <input type="number" id="quantity-input" name="quantity" min="1" value="1" class="w-full border border-gray-300 rounded-md px-3 py-2" required/>
              </div>
              <button type="submit" class="w-full bg-pink-600 text-white py-3 rounded-md font-semibold hover:bg-pink-700 transition flex justify-center items-center space-x-2">
                <i class="fas fa-cart-plus"></i>
                <span>Add to Cart</span>
              </button>
            </form>
            <div class="mt-6 flex space-x-4">
              <button id="back-to-shop-btn" class="text-pink-600 hover:underline cursor-pointer">Back to Shop</button>
            </div>
          </div>
        </div>
      `;
      document.getElementById('back-to-shop-btn').addEventListener('click', () => {
        renderShop(null);
      });
      document.getElementById('product-detail-form').addEventListener('submit', e => {
        e.preventDefault();
        const size = e.target.size.value;
        const color = e.target.color.value;
        const quantity = parseInt(e.target.quantity.value);
        if (!size || !color || quantity < 1) {
          alert('Please select size, color and valid quantity.');
          return;
        }
        addToCart(product.id, size, color, quantity);
        alert('Product added to cart!');
      });
    }

    // Render Cart Page
    function renderCart() {
      currentPage = 'cart';
      currentCategory = null;
      currentProduct = null;
      const main = document.getElementById('main-content');
      if (cart.length === 0) {
        main.innerHTML = `
          <div class="text-center py-20">
            <h2 class="text-3xl font-semibold mb-4">Your Cart is Empty</h2>
            <button id="continue-shopping-btn" class="bg-pink-600 text-white px-6 py-3 rounded-md hover:bg-pink-700 transition cursor-pointer">Continue Shopping</button>
          </div>
        `;
        document.getElementById('continue-shopping-btn').addEventListener('click', () => {
          renderHome();
        });
        updateCartCount();
        return;
      }
      // Calculate total price
      let totalPrice = 0;
      cart.forEach(item => {
        totalPrice += item.price * item.quantity;
      });
      main.innerHTML = `
        <h2 class="text-3xl font-semibold mb-6">Shopping Cart</h2>
        <div class="overflow-x-auto">
          <table class="w-full text-left border border-gray-300 rounded-md">
            <thead class="bg-pink-600 text-white">
              <tr>
                <th class="p-3">Product</th>
                <th class="p-3">Size</th>
                <th class="p-3">Color</th>
                <th class="p-3">Price</th>
                <th class="p-3">Quantity</th>
                <th class="p-3">Total</th>
                <th class="p-3">Remove</th>
              </tr>
            </thead>
            <tbody>
              ${cart.map((item, idx) => `
                <tr class="border-t border-gray-300">
                  <td class="p-3 flex items-center space-x-4">
                    <img alt="${item.alt}" class="w-16 h-16 object-cover rounded" src="${item.image}" width="64" height="64"/>
                    <span>${item.name}</span>
                  </td>
                  <td class="p-3">${item.size}</td>
                  <td class="p-3">${item.color}</td>
                  <td class="p-3">${formatPrice(item.price)}</td>
                  <td class="p-3">
                    <input type="number" min="1" value="${item.quantity}" data-idx="${idx}" class="quantity-input border border-gray-300 rounded px-2 py-1 w-16"/>
                  </td>
                  <td class="p-3">${formatPrice(item.price * item.quantity)}</td>
                  <td class="p-3 text-center">
                    <button data-idx="${idx}" class="remove-item-btn text-red-600 hover:text-red-800">
                      <i class="fas fa-trash-alt"></i>
                    </button>
                  </td>
                </tr>
              `).join('')}
            </tbody>
          </table>
        </div>
        <div class="mt-6 flex justify-between items-center">
          <div class="text-xl font-semibold">
            Total: ${formatPrice(totalPrice)}
          </div>
          <button id="proceed-checkout-btn" class="bg-pink-600 text-white px-6 py-3 rounded-md hover:bg-pink-700 transition cursor-pointer">
            Proceed to Checkout
          </button>
        </div>
      `;
      attachCartListeners();
      updateCartCount();
    }

    // Render Checkout Page
    function renderCheckout() {
      currentPage = 'checkout';
      currentCategory = null;
      currentProduct = null;
      const main = document.getElementById('main-content');
      if (cart.length === 0) {
        main.innerHTML = `
          <div class="text-center py-20">
            <h2 class="text-3xl font-semibold mb-4">Your Cart is Empty</h2>
            <button id="continue-shopping-btn" class="bg-pink-600 text-white px-6 py-3 rounded-md hover:bg-pink-700 transition cursor-pointer">Continue Shopping</button>
          </div>
        `;
        document.getElementById('continue-shopping-btn').addEventListener('click', () => {
          renderHome();
        });
        updateCartCount();
        return;
      }
      // Calculate total price
      let totalPrice = 0;
      cart.forEach(item => {
        totalPrice += item.price * item.quantity;
      });
      main.innerHTML = `
        <h2 class="text-3xl font-semibold mb-6">Checkout</h2>
        <form id="checkout-form" class="max-w-3xl mx-auto space-y-8">
          <section>
            <h3 class="text-xl font-semibold mb-4">Shipping Details</h3>
            <div class="grid grid-cols-1 sm:grid-cols-2 gap-6">
              <div>
                <label for="full-name" class="block font-semibold mb-1">Full Name</label>
                <input type="text" id="full-name" name="fullName" required class="w-full border border-gray-300 rounded-md px-3 py-2" value="${user ? user.email.split('@')[0] : ''}"/>
              </div>
              <div>
                <label for="email" class="block font-semibold mb-1">Email</label>
                <input type="email" id="email" name="email" required class="w-full border border-gray-300 rounded-md px-3 py-2" value="${user ? user.email : ''}"/>
              </div>
              <div class="sm:col-span-2">
                <label for="address" class="block font-semibold mb-1">Address</label>
                <textarea id="address" name="address" rows="3" required class="w-full border border-gray-300 rounded-md px-3 py-2"></textarea>
              </div>
              <div>
                <label for="phone" class="block font-semibold mb-1">Phone Number</label>
                <input type="tel" id="phone" name="phone" required pattern="[0-9]{10}" placeholder="10 digit number" class="w-full border border-gray-300 rounded-md px-3 py-2"/>
              </div>
              <div>
                <label for="city" class="block font-semibold mb-1">City</label>
                <input type="text" id="city" name="city" required class="w-full border border-gray-300 rounded-md px-3 py-2"/>
              </div>
              <div>
                <label for="state" class="block font-semibold mb-1">State</label>
                <input type="text" id="state" name="state" required class="w-full border border-gray-300 rounded-md px-3 py-2"/>
              </div>
              <div>
                <label for="zip" class="block font-semibold mb-1">Zip Code</label>
                <input type="text" id="zip" name="zip" required pattern="[0-9]{5,6}" class="w-full border border-gray-300 rounded-md px-3 py-2"/>
              </div>
            </div>
          </section>
          <section>
            <h3 class="text-xl font-semibold mb-4">Payment Method</h3>
            <div class="space-y-4">
              <label class="inline-flex items-center">
                <input type="radio" name="paymentMethod" value="Credit Card" required class="form-radio text-pink-600"/>
                <span class="ml-2">Credit Card</span>
              </label>
              <label class="inline-flex items-center">
                <input type="radio" name="paymentMethod" value="Debit Card" class="form-radio text-pink-600"/>
                <span class="ml-2">Debit Card</span>
              </label>
              <label class="inline-flex items-center">
                <input type="radio" name="paymentMethod" value="UPI" class="form-radio text-pink-600"/>
                <span class="ml-2">UPI</span>
              </label>
              <label class="inline-flex items-center">
                <input type="radio" name="paymentMethod" value="Cash on Delivery" class="form-radio text-pink-600"/>
                <span class="ml-2">Cash on Delivery</span>
              </label>
            </div>
          </section>
          <section>
            <h3 class="text-xl font-semibold mb-4">Order Summary</h3>
            <ul class="border border-gray-300 rounded-md p-4 space-y-3 max-h-64 overflow-y-auto">
              ${cart.map(item => `
                <li class="flex justify-between">
                  <span>${item.name} (${item.size}, ${item.color}) x ${item.quantity}</span>
                  <span>${formatPrice(item.price * item.quantity)}</span>
                </li>
              `).join('')}
            </ul>
            <div class="mt-4 text-right font-bold text-lg">
              Total: ${formatPrice(totalPrice)}
            </div>
          </section>
          <div class="flex justify-between items-center">
            <button type="button" id="back-to-cart-btn" class="bg-gray-300 text-gray-700 px-6 py-3 rounded-md hover:bg-gray-400 transition cursor-pointer">
              Back to Cart
            </button>
            <button type="submit" class="bg-pink-600 text-white px-6 py-3 rounded-md hover:bg-pink-700 transition cursor-pointer">
              Confirm Order
            </button>
          </div>
        </form>
      `;
      document.getElementById('back-to-cart-btn').addEventListener('click', () => {
        renderCart();
      });
      document.getElementById('checkout-form').addEventListener('submit', async (e) => {
        e.preventDefault();
        if (!e.target.checkValidity()) {
          e.target.reportValidity();
          return;
        }

        const submitButton = e.target.querySelector('button[type="submit"]');
        const originalButtonText = submitButton.innerHTML;
        submitButton.disabled = true;
        submitButton.innerHTML = `<i class="fas fa-spinner fa-spin mr-2"></i>Processing...`;
        
        // Gather form data
        const formData = new FormData(e.target);
        const orderDetails = {
          fullName: formData.get('fullName'),
          email: formData.get('email'),
          address: formData.get('address'),
          phone: formData.get('phone'),
          city: formData.get('city'),
          state: formData.get('state'),
          zip: formData.get('zip'),
          paymentMethod: formData.get('paymentMethod'),
          cart: [...cart]
        };
        
        // Submit order data
        const success = await submitOrder(orderDetails);

        // If submission fails, re-enable the button
        if (!success) {
            submitButton.disabled = false;
            submitButton.innerHTML = originalButtonText;
        }
      });
      updateCartCount();
    }

    // Render About Us Page
    function renderAbout() {
      currentPage = 'about';
      currentCategory = null;
      currentProduct = null;
      const main = document.getElementById('main-content');
      main.innerHTML = `
        <h2 class="text-3xl font-semibold mb-6">About Us</h2>
        <p class="mb-4 max-w-3xl text-gray-700 leading-relaxed">
          Panwar&amp;Son's is India's leading fashion e-commerce platform, offering a wide range of clothing, footwear, accessories, and lifestyle products. Our mission is to bring the latest trends and styles to your doorstep with convenience and trust.
        </p>
        <p class="mb-4 max-w-3xl text-gray-700 leading-relaxed">
          We partner with top brands and designers to provide you with quality products at competitive prices. Customer satisfaction and seamless shopping experience are our top priorities.
        </p>
        <button id="about-back-home" class="mt-6 bg-pink-600 text-white px-6 py-3 rounded-md hover:bg-pink-700 transition cursor-pointer">
          Back to Home
        </button>
      `;
      document.getElementById('about-back-home').addEventListener('click', () => {
        renderHome();
      });
    }

    // Render Contact Us Page
    function renderContact() {
      currentPage = 'contact';
      currentCategory = null;
      currentProduct = null;
      const main = document.getElementById('main-content');
      main.innerHTML = `
        <h2 class="text-3xl font-semibold mb-6">Contact Us</h2>
        <form id="contact-form" class="max-w-3xl mx-auto space-y-6" novalidate>
          <div>
            <label for="contact-name" class="block font-semibold mb-1">Name</label>
            <input type="text" id="contact-name" name="name" required class="w-full border border-gray-300 rounded-md px-3 py-2"/>
          </div>
          <div>
            <label for="contact-email" class="block font-semibold mb-1">Email</label>
            <input type="email" id="contact-email" name="email" required class="w-full border border-gray-300 rounded-md px-3 py-2"/>
          </div>
          <div>
            <label for="contact-subject" class="block font-semibold mb-1">Subject</label>
            <input type="text" id="contact-subject" name="subject" required class="w-full border border-gray-300 rounded-md px-3 py-2"/>
          </div>
          <div>
            <label for="contact-message" class="block font-semibold mb-1">Message</label>
            <textarea id="contact-message" name="message" rows="5" required class="w-full border border-gray-300 rounded-md px-3 py-2"></textarea>
          </div>
          <button type="submit" class="bg-pink-600 text-white px-6 py-3 rounded-md hover:bg-pink-700 transition cursor-pointer">
            Send Message
          </button>
        </form>
      `;
      document.getElementById('contact-form').addEventListener('submit', e => {
        e.preventDefault();
        if (!e.target.checkValidity()) {
          e.target.reportValidity();
          return;
        }
        alert('Thank you for contacting us! We will get back to you soon.');
        e.target.reset();
      });
    }

    // Render Login/Register Page
    function renderLogin() {
      currentPage = 'login';
      currentCategory = null;
      currentProduct = null;
      const main = document.getElementById('main-content');
      main.innerHTML = `
        <h2 class="text-3xl font-semibold mb-6">Login / Register</h2>
        <div class="max-w-md mx-auto space-y-8">
          <form id="login-form" class="space-y-6" novalidate>
            <div>
              <label for="login-email" class="block font-semibold mb-1">Email</label>
              <input type="email" id="login-email" name="email" required class="w-full border border-gray-300 rounded-md px-3 py-2"/>
            </div>
            <div>
              <label for="login-password" class="block font-semibold mb-1">Password</label>
              <input type="password" id="login-password" name="password" required class="w-full border border-gray-300 rounded-md px-3 py-2"/>
            </div>
            <button type="submit" class="bg-pink-600 text-white px-6 py-3 rounded-md hover:bg-pink-700 transition cursor-pointer w-full">
              Login
            </button>
          </form>
          <div class="text-center text-gray-700">
            Don't have an account? <button id="show-register-btn" class="text-pink-600 hover:underline cursor-pointer">Register here</button>
          </div>
          <form id="register-form" class="space-y-6 hidden" novalidate>
            <div>
              <label for="register-email" class="block font-semibold mb-1">Email</label>
              <input type="email" id="register-email" name="email" required class="w-full border border-gray-300 rounded-md px-3 py-2"/>
            </div>
            <div>
              <label for="register-password" class="block font-semibold mb-1">Password</label>
              <input type="password" id="register-password" name="password" required class="w-full border border-gray-300 rounded-md px-3 py-2"/>
            </div>
            <div>
              <label for="register-password-confirm" class="block font-semibold mb-1">Confirm Password</label>
              <input type="password" id="register-password-confirm" name="passwordConfirm" required class="w-full border border-gray-300 rounded-md px-3 py-2"/>
            </div>
            <button type="submit" class="bg-pink-600 text-white px-6 py-3 rounded-md hover:bg-pink-700 transition cursor-pointer w-full">
              Register
            </button>
            <div class="text-center text-gray-700">
              Already have an account? <button id="show-login-btn" class="text-pink-600 hover:underline cursor-pointer">Login here</button>
            </div>
          </form>
        </div>
      `;
      document.getElementById('show-register-btn').addEventListener('click', () => {
        document.getElementById('login-form').classList.add('hidden');
        document.getElementById('register-form').classList.remove('hidden');
      });
      document.getElementById('show-login-btn').addEventListener('click', () => {
        document.getElementById('register-form').classList.add('hidden');
        document.getElementById('login-form').classList.remove('hidden');
      });
      document.getElementById('login-form').addEventListener('submit', e => {
        e.preventDefault();
        if (!e.target.checkValidity()) {
          e.target.reportValidity();
          return;
        }
        const email = e.target.email.value.trim();
        // Simulate fetching user photo from Google profile by using Gravatar or placeholder
        const photoURL = getGravatarUrl(email);
        user = {email, photoURL};
        updateUserDisplay();
        alert('Login successful!');
        renderHome();
      });
      document.getElementById('register-form').addEventListener('submit', e => {
        e.preventDefault();
        if (!e.target.checkValidity()) {
          e.target.reportValidity();
          return;
        }
        const pass = e.target.password.value;
        const passConfirm = e.target.passwordConfirm.value;
        if (pass !== passConfirm) {
          alert('Passwords do not match!');
          return;
        }
        alert('Registration successful!');
        renderHome();
      });
    }

    // Render 404 Page
    function render404() {
      currentPage = '404';
      currentCategory = null;
      currentProduct = null;
      const main = document.getElementById('main-content');
      main.innerHTML = `
        <div class="text-center py-20">
          <h2 class="text-6xl font-bold text-pink-600 mb-4">404</h2>
          <p class="text-2xl mb-6">Page Not Found</p>
          <button id="back-home-btn" class="bg-pink-600 text-white px-6 py-3 rounded-md hover:bg-pink-700 transition cursor-pointer">
            Back to Home
          </button>
        </div>
      `;
      document.getElementById('back-home-btn').addEventListener('click', () => {
        renderHome();
      });
    }

    // Render Thank You Page
    function renderThankYou(orderId) {
      currentPage = 'thankyou';
      currentCategory = null;
      currentProduct = null;
      const main = document.getElementById('main-content');
      main.innerHTML = `
        <div class="text-center py-20 max-w-xl mx-auto">
          <h2 class="text-4xl font-bold text-pink-600 mb-4">Thank You for Your Order!</h2>
          <p class="text-lg mb-6">Your order has been confirmed. Your Order ID is <span class="font-semibold">${orderId}</span>.</p>
          <button id="continue-shopping-btn" class="bg-pink-600 text-white px-6 py-3 rounded-md hover:bg-pink-700 transition cursor-pointer">
            Continue Shopping
          </button>
        </div>
      `;
      document.getElementById('continue-shopping-btn').addEventListener('click', () => {
        cart = [];
        updateCartCount();
        renderHome();
      });
    }

    // Get category image for shop page categories
    function getCategoryImage(category) {
      switch(category) {
        case 'Men': return "https://storage.googleapis.com/a1aa/image/f50ac7c2-9860-4b64-b9d8-4e046377db70.jpg";
        case 'Women': return "https://storage.googleapis.com/a1aa/image/ca7a2178-494a-42db-cfd6-55754bbc6151.jpg";
        case 'Electronics': return "https://storage.googleapis.com/a1aa/image/f342bc1f-abff-43e0-3108-f00da8404186.jpg";
        case 'Footwear': return "https://storage.googleapis.com/a1aa/image/56ba289b-9e94-41ab-e63d-813bdf58f364.jpg";
        case 'Accessories': return "https://storage.googleapis.com/a1aa/image/b4d08e2c-3d3f-47ca-50ac-cb1ddcc8c9a0.jpg";
        case 'Kids': return "https://storage.googleapis.com/a1aa/image/e0f00960-58d0-44d6-5280-938ae48a3efd.jpg";
        default: return "https://placehold.co/120x120/png?text=Category";
      }
    }

    // Add product to cart
    function addToCart(productId, size, color, quantity) {
      let product = null;
      for (const cat in productsData) {
        product = productsData[cat].find(p => p.id === productId);
        if (product) break;
      }
      if (!product) return;
      // Check if product with same options already in cart
      const existingIndex = cart.findIndex(item => item.id === productId && item.size === size && item.color === color);
      if (existingIndex !== -1) {
        cart[existingIndex].quantity += quantity;
      } else {
        cart.push({
          id: product.id,
          name: product.name,
          price: product.price,
          size,
          color,
          quantity,
          image: product.image,
          alt: product.alt
        });
      }
      updateCartCount();
    }

    // Update cart count in header
    function updateCartCount() {
      const count = cart.reduce((acc, item) => acc + item.quantity, 0);
      document.getElementById('cart-count').textContent = count;
    }

    // Attach listeners for home page
    function attachHomeListeners() {
      // Category clicks
      document.querySelectorAll('.category-item').forEach(el => {
        el.addEventListener('click', () => {
          const cat = el.getAttribute('data-category');
          renderShop(cat);
        });
      });
      // Featured product card clicks (except add to cart button)
      document.querySelectorAll('.product-card').forEach(card => {
        card.addEventListener('click', e => {
          if (e.target.closest('.add-to-cart-btn')) return;
          const id = card.getAttribute('data-id');
          renderProduct(id);
        });
      });
      // Add to cart buttons on featured products
      attachAddToCartListeners();
      // Hero shop now button
      const heroShopBtn = document.getElementById('hero-shop-now');
      if(heroShopBtn) {
        heroShopBtn.addEventListener('click', () => {
          renderShop(null);
        });
      }
      // Newsletter form
      const newsletterForm = document.getElementById('newsletter-form');
      if(newsletterForm) {
        newsletterForm.addEventListener('submit', e => {
          e.preventDefault();
          const emailInput = document.getElementById('newsletter-email');
          if (!emailInput.value || !emailInput.checkValidity()) {
            emailInput.reportValidity();
            return;
          }
          alert('Thank you for subscribing!');
          emailInput.value = '';
        });
      }
    }

    // Attach listeners for category page
    function attachCategoryListeners() {
      document.querySelectorAll('.category-item').forEach(el => {
        el.addEventListener('click', () => {
          const cat = el.getAttribute('data-category');
          renderShop(cat);
        });
      });
    }

    // Attach listeners for product cards (category page)
    function attachProductCardListeners() {
      document.querySelectorAll('.product-card').forEach(card => {
        card.addEventListener('click', e => {
          if (e.target.closest('.add-to-cart-btn')) return;
          const id = card.getAttribute('data-id');
          renderProduct(id);
        });
      });
      attachAddToCartListeners();
    }

    // Attach add to cart buttons listeners
    function attachAddToCartListeners() {
      document.querySelectorAll('.add-to-cart-btn').forEach(btn => {
        btn.addEventListener('click', e => {
          e.stopPropagation();
          const id = btn.getAttribute('data-id');
          // For buttons on product cards, add with default options
          let product = null;
          for (const cat in productsData) {
            product = productsData[cat].find(p => p.id === id);
            if (product) break;
          }
          if (!product) return;
          // Use first size and color or N/A
          const size = product.sizes.length > 0 ? product.sizes[0] : 'N/A';
          const color = product.colors.length > 0 ? product.colors[0] : 'N/A';
          addToCart(id, size, color, 1);
          alert('Product added to cart!');
        });
      });
      updateCartCount();
    }

    // Attach listeners for cart page
    function attachCartListeners() {
      // Quantity inputs
      document.querySelectorAll('.quantity-input').forEach(input => {
        input.addEventListener('change', e => {
          const idx = parseInt(e.target.getAttribute('data-idx'));
          let val = parseInt(e.target.value);
          if (isNaN(val) || val < 1) {
            val = 1;
            e.target.value = 1;
          }
          cart[idx].quantity = val;
          renderCart();
        });
      });
      // Remove buttons
      document.querySelectorAll('.remove-item-btn').forEach(btn => {
        btn.addEventListener('click', e => {
          const idx = parseInt(btn.getAttribute('data-idx'));
          cart.splice(idx, 1);
          renderCart();
        });
      });
      // Proceed to checkout button
      const checkoutBtn = document.getElementById('proceed-checkout-btn');
      if (checkoutBtn) {
        checkoutBtn.addEventListener('click', () => {
          renderCheckout();
        });
      }
      updateCartCount();
    }

    // Submit order details to a form backend service like Formspree
    async function submitOrder(orderDetails) {
      // Generate a unique order ID
      const orderId = 'PNS' + Date.now();
      
      // IMPORTANT: Replace this placeholder with your own Formspree endpoint URL!
      const formEndpoint = 'https://formspree.io/f/mvgbpyav';

      // Prepare the data for submission in a readable format
      const totalPrice = orderDetails.cart.reduce((acc, item) => acc + item.price * item.quantity, 0);
      const cartSummary = orderDetails.cart.map(item => 
        `- ${item.name} (Size: ${item.size}, Color: ${item.color}) x ${item.quantity} @ ${formatPrice(item.price)}`
      ).join('\n');
      
      const submissionData = {
        'Order ID': orderId,
        'Customer Name': orderDetails.fullName,
        'Email': orderDetails.email,
        'Phone': orderDetails.phone,
        'Shipping Address': `${orderDetails.address}, ${orderDetails.city}, ${orderDetails.state} - ${orderDetails.zip}`,
        'Payment Method': orderDetails.paymentMethod,
        'Total Amount': formatPrice(totalPrice),
        '--- Order Items ---': '--------------------',
        'Items': cartSummary,
      };

      try {
        const response = await fetch(formEndpoint, {
          method: 'POST',
          body: JSON.stringify(submissionData),
          headers: {
            'Content-Type': 'application/json',
            'Accept': 'application/json'
          }
        });

        if (response.ok) {
          // If submission is successful, show the thank you page
          renderThankYou(orderId);
          return true;
        } else {
          // Handle server-side errors from the form endpoint
          const data = await response.json();
          if (data.errors) {
            alert(`Submission failed: ${data.errors.map(error => error.message).join(', ')}`);
          } else {
            alert('An unexpected error occurred. Please try again.');
          }
          return false;
        }
      } catch (error) {
        // Handle network errors (e.g., user is offline)
        console.error('Error submitting order:', error);
        alert('Could not send order details. Please check your internet connection and try again.');
        return false;
      }
    }

    // Get Gravatar URL for email (fallback to placeholder)
    function getGravatarUrl(email) {
      const trimmed = email.trim().toLowerCase();
      // MD5 function is required for Gravatar. Assuming it's defined below.
      // If md5 function is not available, this will cause an error.
      // Let's add a check to prevent that.
      if (typeof md5 === 'function') {
        const hash = md5(trimmed);
        return `https://www.gravatar.com/avatar/${hash}?d=identicon&s=40`;
      }
      return `https://placehold.co/40x40/png?text=${email.charAt(0).toUpperCase()}`;
    }

    // MD5 function for gravatar hash (from https://stackoverflow.com/a/16552188)
    function md5(string) {
      function RotateLeft(lValue, iShiftBits) {
        return (lValue<<iShiftBits) | (lValue>>>(32-iShiftBits));
      }
      function AddUnsigned(lX,lY) {
        let lX4,lY4,lX8,lY8,lResult;
        lX8 = (lX & 0x80000000);
        lY8 = (lY & 0x80000000);
        lX4 = (lX & 0x40000000);
        lY4 = (lY & 0x40000000);
        lResult = (lX & 0x3FFFFFFF)+(lY & 0x3FFFFFFF);
        if (lX4 & lY4) {
          return (lResult ^ 0x80000000 ^ lX8 ^ lY8);
        }
        if (lX4 | lY4) {
          if (lResult & 0x40000000) {
            return (lResult ^ 0xC0000000 ^ lX8 ^ lY8);
          } else {
            return (lResult ^ 0x40000000 ^ lX8 ^ lY8);
          }
        } else {
          return (lResult ^ lX8 ^ lY8);
        }
      }
      function F(x,y,z) { return (x & y) | ((~x) & z); }
      function G(x,y,z) { return (x & z) | (y & (~z)); }
      function H(x,y,z) { return (x ^ y ^ z); }
      function I(x,y,z) { return (y ^ (x | (~z))); }
      function FF(a,b,c,d,x,s,ac) {
        a = AddUnsigned(a, AddUnsigned(AddUnsigned(F(b, c, d), x), ac));
        return AddUnsigned(RotateLeft(a, s), b);
      }
      function GG(a,b,c,d,x,s,ac) {
        a = AddUnsigned(a, AddUnsigned(AddUnsigned(G(b, c, d), x), ac));
        return AddUnsigned(RotateLeft(a, s), b);
      }
      function HH(a,b,c,d,x,s,ac) {
        a = AddUnsigned(a, AddUnsigned(AddUnsigned(H(b, c, d), x), ac));
        return AddUnsigned(RotateLeft(a, s), b);
      }
      function II(a,b,c,d,x,s,ac) {
        a = AddUnsigned(a, AddUnsigned(AddUnsigned(I(b, c, d), x), ac));
        return AddUnsigned(RotateLeft(a, s), b);
      }
      function ConvertToWordArray(string) {
        let lWordCount;
        const lMessageLength = string.length;
        const lNumberOfWords_temp1=lMessageLength + 8;
        const lNumberOfWords_temp2=(lNumberOfWords_temp1-(lNumberOfWords_temp1 % 64))/64;
        const lNumberOfWords = (lNumberOfWords_temp2+1)*16;
        const lWordArray=Array(lNumberOfWords-1);
        let lBytePosition = 0;
        let lByteCount = 0;
        while ( lByteCount < lMessageLength ) {
          lWordCount = (lByteCount-(lByteCount % 4))/4;
          lBytePosition = (lByteCount % 4)*8;
          lWordArray[lWordCount] = (lWordArray[lWordCount] | (string.charCodeAt(lByteCount)<<lBytePosition));
          lByteCount++;
        }
        lWordCount = (lByteCount-(lByteCount % 4))/4;
        lBytePosition = (lByteCount % 4)*8;
        lWordArray[lWordCount] = lWordArray[lWordCount] | (0x80<<lBytePosition);
        lWordArray[lNumberOfWords-2] = lMessageLength<<3;
        lWordArray[lNumberOfWords-1] = lMessageLength>>>29;
        return lWordArray;
      }
      function WordToHex(lValue) {
        let WordToHexValue="",WordToHexValue_temp="",lByte,lCount;
        for (lCount = 0; lCount<=3; lCount++) {
          lByte = (lValue>>>(lCount*8)) & 255;
          WordToHexValue_temp = "0" + lByte.toString(16);
          WordToHexValue = WordToHexValue + WordToHexValue_temp.substr(WordToHexValue_temp.length-2,2);
        }
        return WordToHexValue;
      }
      function utf8Encode(string) {
        string = string.replace(/\r\n/g,"\n");
        let utftext = "";
        for (let n = 0; n < string.length; n++) {
            const c = string.charCodeAt(n);
            if (c < 128) {
                utftext += String.fromCharCode(c);
            }
            else if((c > 127) && (c < 2048)) {
                utftext += String.fromCharCode((c >> 6) | 192);
                utftext += String.fromCharCode((c & 63) | 128);
            }
            else {
                utftext += String.fromCharCode((c >> 12) | 224);
                utftext += String.fromCharCode(((c >> 6) & 63) | 128);
                utftext += String.fromCharCode((c & 63) | 128);
            }
        }
        return utftext;
      }
      let x=Array();
      let k,AA,BB,CC,DD,a,b,c,d;
      const S11=7, S12=12, S13=17, S14=22;
      const S21=5, S22=9 , S23=14, S24=20;
      const S31=4, S32=11, S33=16, S34=23;
      const S41=6, S42=10, S43=15, S44=21;
      string = utf8Encode(string);
      x = ConvertToWordArray(string);
      a = 0x67452301;
      b = 0xEFCDAB89;
      c = 0x98BADCFE;
      d = 0x10325476;
      for (k=0;k<x.length;k+=16) {
        AA=a; BB=b; CC=c; DD=d;
        a=FF(a,b,c,d,x[k+0], S11,0xD76AA478);
        d=FF(d,a,b,c,x[k+1], S12,0xE8C7B756);
        c=FF(c,d,a,b,x[k+2], S13,0x242070DB);
        b=FF(b,c,d,a,x[k+3], S14,0xC1BDCEEE);
        a=FF(a,b,c,d,x[k+4], S11,0xF57C0FAF);
        d=FF(d,a,b,c,x[k+5], S12,0x4787C62A);
        c=FF(c,d,a,b,x[k+6], S13,0xA8304613);
        b=FF(b,c,d,a,x[k+7], S14,0xFD469501);
        a=FF(a,b,c,d,x[k+8], S11,0x698098D8);
        d=FF(d,a,b,c,x[k+9], S12,0x8B44F7AF);
        c=FF(c,d,a,b,x[k+10],S13,0xFFFF5BB1);
        b=FF(b,c,d,a,x[k+11],S14,0x895CD7BE);
        a=FF(a,b,c,d,x[k+12],S11,0x6B901122);
        d=FF(d,a,b,c,x[k+13],S12,0xFD987193);
        c=FF(c,d,a,b,x[k+14],S13,0xA679438E);
        b=FF(b,c,d,a,x[k+15],S14,0x49B40821);
        a=GG(a,b,c,d,x[k+1], S21,0xF61E2562);
        d=GG(d,a,b,c,x[k+6], S22,0xC040B340);
        c=GG(c,d,a,b,x[k+11],S23,0x265E5A51);
        b=GG(b,c,d,a,x[k+0], S24,0xE9B6C7AA);
        a=GG(a,b,c,d,x[k+5], S21,0xD62F105D);
        d=GG(d,a,b,c,x[k+10],S22,0x2441453);
        c=GG(c,d,a,b,x[k+15],S23,0xD8A1E681);
        b=GG(b,c,d,a,x[k+4], S24,0xE7D3FBC8);
        a=GG(a,b,c,d,x[k+9], S21,0x21E1CDE6);
        d=GG(d,a,b,c,x[k+14],S22,0xC33707D6);
        c=GG(c,d,a,b,x[k+3], S23,0xF4D50D87);
        b=GG(b,c,d,a,x[k+8], S24,0x455A14ED);
        a=GG(a,b,c,d,x[k+13],S21,0xA9E3E905);
        d=GG(d,a,b,c,x[k+2], S22,0xFCEFA3F8);
        c=GG(c,d,a,b,x[k+7], S23,0x676F02D9);
        b=GG(b,c,d,a,x[k+12],S24,0x8D2A4C8A);
        a=HH(a,b,c,d,x[k+5], S31,0xFFFA3942);
        d=HH(d,a,b,c,x[k+8], S32,0x8771F681);
        c=HH(c,d,a,b,x[k+11],S33,0x6D9D6122);
        b=HH(b,c,d,a,x[k+14],S34,0xFDE5380C);
        a=HH(a,b,c,d,x[k+1], S31,0xA4BEEA44);
        d=HH(d,a,b,c,x[k+4], S32,0x4BDECFA9);
        c=HH(c,d,a,b,x[k+7], S33,0xF6BB4B60);
        b=HH(b,c,d,a,x[k+10],S34,0xBEBFBC70);
        a=HH(a,b,c,d,x[k+13],S31,0x289B7EC6);
        d=HH(d,a,b,c,x[k+0], S32,0xEAA127FA);
        c=HH(c,d,a,b,x[k+3], S33,0xD4EF3085);
        b=HH(b,c,d,a,x[k+6], S34,0x4881D05);
        a=HH(a,b,c,d,x[k+9], S31,0xD9D4D039);
        d=HH(d,a,b,c,x[k+12],S32,0xE6DB99E5);
        c=HH(c,d,a,b,x[k+15],S33,0x1FA27CF8);
        b=HH(b,c,d,a,x[k+2], S34,0xC4AC5665);
        a=II(a,b,c,d,x[k+0], S41,0xF4292244);
        d=II(d,a,b,c,x[k+7], S42,0x432AFF97);
        c=II(c,d,a,b,x[k+14],S43,0xAB9423A7);
        b=II(b,c,d,a,x[k+5], S44,0xFC93A039);
        a=II(a,b,c,d,x[k+12],S41,0x655B59C3);
        d=II(d,a,b,c,x[k+3], S42,0x8F0CCC92);
        c=II(c,d,a,b,x[k+10],S43,0xFFEFF47D);
        b=II(b,c,d,a,x[k+1], S44,0x85845DD1);
        a=II(a,b,c,d,x[k+8], S41,0x6FA87E4F);
        d=II(d,a,b,c,x[k+15],S42,0xFE2CE6E0);
        c=II(c,d,a,b,x[k+6], S43,0xA3014314);
        b=II(b,c,d,a,x[k+13],S44,0x4E0811A1);
        a=II(a,b,c,d,x[k+4], S41,0xF7537E82);
        d=II(d,a,b,c,x[k+11],S42,0xBD3AF235);
        c=II(c,d,a,b,x[k+2], S43,0x2AD7D2BB);
        b=II(b,c,d,a,x[k+9], S44,0xEB86D391);
        a=AddUnsigned(a,AA);
        b=AddUnsigned(b,BB);
        c=AddUnsigned(c,CC);
        d=AddUnsigned(d,DD);
      }
      const temp = WordToHex(a)+WordToHex(b)+WordToHex(c)+WordToHex(d);
      return temp.toLowerCase();
    }

    // Navigation handlers
    function setupNavigation() {
      // Desktop nav
      document.getElementById('nav-home-desktop').addEventListener('click', () => renderHome());
      document.getElementById('nav-shop-desktop').addEventListener('click', () => renderShop(null));
      document.getElementById('nav-about-desktop').addEventListener('click', () => renderAbout());
      document.getElementById('nav-contact-desktop').addEventListener('click', () => renderContact());
      document.getElementById('nav-login-desktop').addEventListener('click', () => renderLogin());
      // Mobile nav
      document.getElementById('nav-home-mobile').addEventListener('click', () => {
        renderHome();
        toggleMobileMenu(false);
      });
      document.getElementById('nav-shop-mobile').addEventListener('click', () => {
        renderShop(null);
        toggleMobileMenu(false);
      });
      document.getElementById('nav-about-mobile').addEventListener('click', () => {
        renderAbout();
        toggleMobileMenu(false);
      });
      document.getElementById('nav-contact-mobile').addEventListener('click', () => {
        renderContact();
        toggleMobileMenu(false);
      });
      document.getElementById('nav-login-mobile').addEventListener('click', () => {
        renderLogin();
        toggleMobileMenu(false);
      });
      // Logo click
      document.getElementById('nav-home').addEventListener('click', () => renderHome());
      document.getElementById('footer-logo').addEventListener('click', () => renderHome());
      // Footer links (About)
      document.getElementById('footer-our-story').addEventListener('click', () => renderAbout());
      document.getElementById('footer-careers').addEventListener('click', () => alert('Careers page coming soon!'));
      document.getElementById('footer-press').addEventListener('click', () => alert('Press page coming soon!'));
      document.getElementById('footer-blog').addEventListener('click', () => alert('Blog page coming soon!'));
      // Footer links (Help)
      document.getElementById('footer-customer-service').addEventListener('click', () => alert('Customer Service page coming soon!'));
      document.getElementById('footer-returns').addEventListener('click', () => alert('Returns & Refunds page coming soon!'));
      document.getElementById('footer-shipping-info').addEventListener('click', () => alert('Shipping Info page coming soon!'));
      document.getElementById('footer-faqs').addEventListener('click', () => alert('FAQs page coming soon!'));
      // Cart icon click
      document.getElementById('nav-cart-desktop').addEventListener('click', () => renderCart());
      // Logout button
      document.getElementById('logout-btn').addEventListener('click', () => {
        user = null;
        updateUserDisplay();
        alert('Logged out successfully.');
        renderHome();
      });
    }

    // Mobile menu toggle
    function toggleMobileMenu(show) {
      const menu = document.getElementById('mobile-menu');
      if (show === undefined) {
        menu.classList.toggle('hidden');
      } else if (show) {
        menu.classList.remove('hidden');
      } else {
        menu.classList.add('hidden');
      }
    }

    // Setup mobile menu button
    document.getElementById('mobile-menu-button').addEventListener('click', () => {
      toggleMobileMenu();
    });

    // Search functionality (basic)
    function setupSearch() {
      const searchInput = document.getElementById('search-input');
      const searchButton = document.getElementById('search-button');
      const mobileSearchInput = document.getElementById('mobile-search-input');
      const mobileSearchButton = document.getElementById('mobile-search-button');
      function doSearch(query) {
        if (!query) {
          alert('Please enter a search term.');
          return;
        }
        // Search products by name (case insensitive)
        let results = [];
        for (const cat in productsData) {
          results = results.concat(productsData[cat].filter(p => p.name.toLowerCase().includes(query.toLowerCase())));
        }
        renderSearchResults(query, results);
      }
      if (searchButton) {
        searchButton.addEventListener('click', () => {
          doSearch(searchInput.value.trim());
        });
      }
      if (searchInput) {
        searchInput.addEventListener('keydown', e => {
          if (e.key === 'Enter') {
            e.preventDefault();
            doSearch(searchInput.value.trim());
          }
        });
      }
      if (mobileSearchButton) {
        mobileSearchButton.addEventListener('click', e => {
          e.preventDefault();
          doSearch(mobileSearchInput.value.trim());
          toggleMobileMenu(false);
        });
      }
      if (mobileSearchInput) {
        mobileSearchInput.addEventListener('keydown', e => {
          if (e.key === 'Enter') {
            e.preventDefault();
            doSearch(mobileSearchInput.value.trim());
            toggleMobileMenu(false);
          }
        });
      }
    }

    // Render Search Results Page
    function renderSearchResults(query, results) {
      currentPage = 'search';
      currentCategory = null;
      currentProduct = null;
      const main = document.getElementById('main-content');
      main.innerHTML = `
        <h2 class="text-3xl font-semibold mb-6">Search Results for "${query}"</h2>
        ${results.length === 0 ? `<p class="text-gray-700">No products found matching your search.</p>` : `
          <div class="grid grid-cols-2 sm:grid-cols-3 md:grid-cols-4 lg:grid-cols-5 gap-6" id="search-results">
            ${results.map(p => `
              <article class="border border-gray-200 rounded-lg overflow-hidden shadow-sm hover:shadow-lg transition relative group cursor-pointer product-card" data-id="${p.id}">
                <img alt="${p.alt}" class="w-full h-64 object-cover" height="400" src="${p.image}" width="300"/>
                <div class="p-4">
                  <h3 class="text-gray-900 font-semibold text-lg truncate">${p.name}</h3>
                  <p class="text-pink-600 font-bold mt-1">${formatPrice(p.price)}</p>
                  <div class="flex items-center mt-2 space-x-1 text-yellow-400">${createStarRating(p.rating, p.reviews)}</div>
                  <button aria-label="Add ${p.name} to cart" class="mt-4 w-full bg-pink-600 text-white py-2 rounded-md font-semibold hover:bg-pink-700 transition flex justify-center items-center space-x-2 add-to-cart-btn" data-id="${p.id}">
                    <i class="fas fa-cart-plus"></i>
                    <span>Add to Cart</span>
                  </button>
                </div>
              </article>
            `).join('')}
          </div>
        `}
        <button id="back-to-home-btn" class="mt-8 bg-pink-600 text-white px-6 py-3 rounded-md hover:bg-pink-700 transition cursor-pointer">
          Back to Home
        </button>
      `;
      document.getElementById('back-to-home-btn').addEventListener('click', () => {
        renderHome();
      });
      attachProductCardListeners();
      attachAddToCartListeners();
    }

    // Initialize app
    function init() {
      setupNavigation();
      setupSearch();
      updateUserDisplay();
      renderHome();
      updateCartCount();
    }

    window.onload = init;
  </script>
 </body>

</html>
